# 简易秒表程序设计任务书

## 任务目标

基于 STC8H 系列 MCU 开发简易秒表，通过 TM1650 数码管显示，实现精确计时（MM:SS 格式，00:00-99:59 范围，1 毫秒级精度），支持启动 / 停止、复位操作，并有视觉反馈。

## 硬件要求

1. **核心组件**：STC8H 系列 MCU（24MHz 时钟，3.3V/5V 工作电压）、TM1650 4 位共阴数码管、2 个独立按键（KEY1、KEY2）、3 色 LED（绿、红、蓝）。
2. **引脚定义**：

- **数码管**：SCL 接 P15，SDA 接 P14。

- **按键**：KEY1（启动 / 停止）接 P32，KEY2（复位）接 P33。

- **LED**：绿色（运行）接 P00，红色（暂停）接 P01，蓝色（清零）接 P02。

3. **连接方式**：数码管采用 IIC 通信，按键用上拉电阻（按下接地），LED 共阳极（低电平点亮）。

## 功能要求

1. **核心功能**：

- 计时：精确到毫秒，范围 00:00-99:59，达 99:59 自动停止并清零。

- 控制：KEY1 控制启动 / 停止，KEY2 复位至 00:00。

2. **显示特性**：

- 格式为 MM:SS，分秒分隔符 “:”（左数第二位小数点）每秒闪烁一次。

- 分钟个位数字稳定显示，溢出自动停止。

3. **状态指示**：

- 绿色 LED 亮：运行中；红色 LED 亮：暂停；蓝色 LED 亮：清零状态。

- 按键消抖，防止误触发。

## 软件架构

1. **主要模块**：

- 系统层：主程序（main.c）、任务调度（Task.c/h）、定时器中断（Timer.c/h）。


- 用户层：秒表功能实现（User_Stopwatch.c/h）。


- 驱动层：数码管（TM1650.c/h）、按键（Key.c/h）、LED（LED.c/h）、软件 IIC（Softiic.c/h）。


2. **核心机制**：定时器 0 提供 1ms 时间片，任务调度周期更新秒表状态。

## 技术要点

1. 计时精度：基于 1ms 定时器中断和任务调度保证。
2. 显示优化：控制数码管位序，实现小数点闪烁与数字稳定显示分离。
3. 按键处理：20ms 延时消抖，检测按键状态并映射功能。

## 使用说明

1. 启动后显示 00:00，蓝色 LED 亮。
2. 按 KEY1 启动计时（绿色 LED 亮，分隔符闪烁），再按 KEY1 暂停（红色 LED 亮，分隔符停闪）。
3. 按 KEY2 复位至 00:00（蓝色 LED 亮）。
4. 计时到 99:59 自动停止并清零。